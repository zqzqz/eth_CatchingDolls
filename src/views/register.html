<style type="text/css">
  .m15{ margin: 15px;}
   .tc{ text-align: center;font-size: 18px;font-weight: 600;}
</style>
  <div class="container">
      <form class="col-md-offset-4 col-sm-offset-4 col-sm-4 col-md-4 form-horizontal" id="registerForm" role="form" method="post" onsubmit="return false">
          <fieldset>
              <legend></legend>
              <div class="panel panel-default">
              <div class="panel-heading">
                  <p class="tc">注册信息</p>
              </div>
              <div class="panel-body m15">
              <div class="form-group">
                  <div class="input-group">
                      <span class="input-group-addon">
                      <span class="glyphicon glyphicon-user"></span>
                      </span>
                      <input type="text" class="form-control" id="username" name="username" placeholder="请输入用户名(username)" required>
                  </div>
              </div>
              <div class="form-group">
                  <div class="input-group">
                      <span class="input-group-addon">
                      <span class="glyphicon glyphicon-lock"></span>
                      </span>
                      <input type="text" class="form-control" id="password" name="password" placeholder="请输入密码(password)" required>
                  </div>
              </div>
              <div class="form-group">
                  <div class="input-group">
                      <span class="input-group-addon">
                      <span class="glyphicon glyphicon-lock"></span>
                      </span>
                      <input type="text" class="form-control" id="password1" name="password1" placeholder="请再次输入密码(password again)" required>
                  </div>
              </div>
              <div class="form-group">
                  <div class="input-group">
                      <span class="input-group-addon">
                      <span class="glyphicon glyphicon-envelope"></span>
                      </span>
                      <input type="text" class="form-control" id="email" name="email" placeholder="输入您的邮箱(e-mail)" required>
                  </div>
                </div>
              <div class="form-group">
                  <div class="input-group">
                      <span class="input-group-addon">
                      <span class="glyphicon glyphicon-lock"></span>
                      </span>
                      <input type="text" class="form-control" id="publickey" name="publickey" placeholder="输入公钥地址(eth publickey address)" required>
                  </div>
              </div>

              <div class="form-group">
                      <button type="submit" class="btn btn-primary btn-block" id="register1">注册</button>
              </div>
              <div class="form-group">
                      <button type="button" class="btn btn-info col-sm-2 col-sm-offset-10" id="login1">登录</button>
              </div>
              </div>
              </div>
          </fieldset>
      </form>
  </div>

  <script type="text/javascript" src="javascripts/jquery.validate.min.js"></script>
  <script type="text/javascript">
    $(function(){
      // use jquery validator to check the form before submit
      $.validator.addMethod("regex", function(value, element, regexpr) {
        return regexpr.test(value);
      }, "格式错误");
      $('#registerForm').validate({
        errorPlacement: function(error, element) {
          // place error in new row
          $(element).closest(".form-group").append(error);
        },
        rules: {
          username: {
            required: true,
            minlength: 5,
            maxlength: 20,
            regex: /^[a-zA-Z0-9_\-]{5,20}$/
          },
          password: {
            required: true,
            minlength: 6,
            maxlength: 20,
            regex: /^[a-zA-Z0-9_\-!@#$%^&*?]{6,20}$/
          },
          password1: {
            required: true,
            equalTo: "#password"
          },
          email: {
            required: true,
            email: true
          },
          publickey: {
            required: true,
            regex: /^0x[0-9a-f]{40}$/
          }
        },
        
        messages: {
          username: {
            required: "请填写用户名",
            minlength: "用户名不能少于5个字符",
            maxlength: "用户名不能超过20个字符",
            regex: "用户名只能包含数字、字母以及‘-’‘_’"
          },
          password: {
            required: "请填写密码",
            minlength: "密码不能少于6位",
            maxlength: "密码不能多于20位",
            regex: "密码只能包含数字、字母及部分特殊字符(-_!@#$%^&*?)"
          },
          password1: {
            required: "请再次输入密码",
            equalTo: "两次输入密码不符"
          },
          email: {
            required: "请填写电子邮箱",
            email: "邮箱地址格式错误"
          },
          publickey: {
            required: "请填写以太坊(ethereum)公钥地址",
            regex: "公钥地址格式错误，请统一使用小写字母并检查位数"
          }
        }
      });
      $("#login1").click(function(){ 
          location.href = 'login';
      });
      $("#register1").click(function(){ 

        var username = $("#username").val();
        var password = $("#password").val();
        var email = $("#email").val();
        var publickey = $("#publickey").val();
        var data = {"username":username,"password":password, "email":email, "publickey":publickey};
        $.ajax({ 
          url: '/register',
          type: 'post',
          data: data,
          success: function(data,status){ 
              if(status == 'success'){ 
                  location.href = 'login';
              }
          },
          error: function(data,err){
              console.log(err);
              location.href = 'register';
          }
        });
      });
  });
</script>
<style>
.error{
  color:red;
}
</style>
